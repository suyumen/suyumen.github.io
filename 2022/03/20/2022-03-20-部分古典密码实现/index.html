<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><meta name="author" content="suyumen"><meta name="renderer" content="webkit"><meta name="copyright" content="suyumen"><meta name="keywords" content="SUYUMEN"><meta name="description" content=""><meta name="Cache-Control" content="no-cache"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>部分古典密码实现 · SUYUMEN</title><link rel="stylesheet" href="/css/style.css?v=2018.7.9"><link rel="stylesheet" href="/css/animation.css?v=2018.7.9"><link rel="icon" href="/img/assets/favicon.ico"><link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.6"><!-- scripts--><script>(function( w ){
  "use strict";
  // rel=preload support test
  if( !w.loadCSS ){
    w.loadCSS = function(){};
  }
  // define on the loadCSS obj
  var rp = loadCSS.relpreload = {};
  // rel=preload feature support test
  // runs once and returns a function for compat purposes
  rp.support = (function(){
    var ret;
    try {
      ret = w.document.createElement( "link" ).relList.supports( "preload" );
    } catch (e) {
      ret = false;
    }
    return function(){
      return ret;
    };
  })();

  // if preload isn't supported, get an asynchronous load by using a non-matching media attribute
  // then change that media back to its intended value on load
  rp.bindMediaToggle = function( link ){
    // remember existing media attr for ultimate state, or default to 'all'
    var finalMedia = link.media || "all";

    function enableStylesheet(){
      link.media = finalMedia;
    }

    // bind load handlers to enable media
    if( link.addEventListener ){
      link.addEventListener( "load", enableStylesheet );
    } else if( link.attachEvent ){
      link.attachEvent( "onload", enableStylesheet );
    }

    // Set rel and non-applicable media type to start an async request
    // note: timeout allows this to happen async to let rendering continue in IE
    setTimeout(function(){
      link.rel = "stylesheet";
      link.media = "only x";
    });
    // also enable media after 3 seconds,
    // which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
    setTimeout( enableStylesheet, 3000 );
  };

  // loop through link elements in DOM
  rp.poly = function(){
    // double check this to prevent external calls from running
    if( rp.support() ){
      return;
    }
    var links = w.document.getElementsByTagName( "link" );
    for( var i = 0; i < links.length; i++ ){
      var link = links[ i ];
      // qualify links to those with rel=preload and as=style attrs
      if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
        // prevent rerunning on link
        link.setAttribute( "data-loadcss", true );
        // bind listeners to toggle media back
        rp.bindMediaToggle( link );
      }
    }
  };

  // if unsupported, run the polyfill
  if( !rp.support() ){
    // run once at least
    rp.poly();

    // rerun poly on an interval until onload
    var run = w.setInterval( rp.poly, 500 );
    if( w.addEventListener ){
      w.addEventListener( "load", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    } else if( w.attachEvent ){
      w.attachEvent( "onload", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    }
  }


  // commonjs
  if( typeof exports !== "undefined" ){
    exports.loadCSS = loadCSS;
  }
  else {
    w.loadCSS = loadCSS;
  }
}( typeof global !== "undefined" ? global : this ) );</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" defer></script><script src="/js/main.js?v=2018.7.9" defer></script><!-- fancybox--><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script><!-- busuanzi--><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body><section class="profile-close" id="cxo-profile"><div class="profile-avatar"><i class="fa fa-caret-left"></i><img src="/img/assets/avatar.jpg"></div><!--.profile-saying
  i.fa.fa-comment
  .saying--><div class="cxo-profile-inner"><div class="profile-name">suyumen</div><div class="profile-signature">目前主要在学习web相关</div><div class="read-progress"></div></div></section><header id="cxo-intro" style="height: 70vh;background-image: url(/img/intro/back.jpg);"><nav id="cxo-intro-nav"><section><div class="intro-nav-title"><a href="/">SUYUMEN</a></div><div class="intro-nav-label-box"><a href="/">Home</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div><i class="fa fa-bars intro-nav-menu"><div class="intro-nav-drop"><a href="/">Home</a><a href="/archives/">Archives</a><a href="/tags/">Tags</a></div></i><div class="clear"></div></section></nav><h1 class="post-title">部分古典密码实现</h1><div class="post-intros"><div class="post-intro-meta"><span class="post-intro-time"><i class="post-intro-calendar fa fa-calendar"></i><span>2022-03-20</span></span><span class="post-intro-tags"><a class="intro-tag fa fa-tag" href="javascript:void(0)" date-tags="js"> js</a><a class="intro-tag fa fa-tag" href="javascript:void(0)" date-tags="密码"> 密码</a></span></div><div class="post-intro-read"><span> Word count: <span class="post-count">2.3k</span> | Reading time: <span class="post-count">12</span>min</span></div></div></header><article class="cxo-up" id="cxo-content-outer"><section id="cxo-content-inner"><article class="article-entry" id="post"><ul>
<li><p>加密：仿射密码加密结果为：[14,25,18]</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> p = [<span class="number">7</span>, <span class="number">14</span>, <span class="number">19</span>];</span><br><span class="line"><span class="keyword">const</span> k = [<span class="number">9</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> value = [];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params">p, k, value</span>) </span>&#123;<span class="comment">//加密</span></span><br><span class="line">    <span class="keyword">let</span> l = p.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; l; i++) &#123;</span><br><span class="line">        value.push((p[i] * k[<span class="number">0</span>] + k[<span class="number">1</span>]) % <span class="number">26</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">encode(p, k, value);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;仿射密码加密结果为：[&quot;</span> + value.toString() + <span class="string">&quot;]&quot;</span>);</span><br></pre></td></tr></table></figure>
<span id="more"></span></li>
<li><p>解密：<br>仿射密码解密结果为：[7,14,19]</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> k = [<span class="number">9</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">const</span> c = [<span class="number">14</span>, <span class="number">25</span>, <span class="number">18</span>];</span><br><span class="line"><span class="keyword">let</span> value = [];</span><br><span class="line"><span class="keyword">let</span> v = [];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decode</span>(<span class="params">c, k, value</span>) </span>&#123;<span class="comment">//解密</span></span><br><span class="line">    <span class="keyword">let</span> l = c.length;</span><br><span class="line">    exgcd(<span class="number">26</span>, k[<span class="number">0</span>], v);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; l; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> m = (c[i] - k[<span class="number">1</span>]) * v[<span class="number">1</span>] % <span class="number">26</span>;</span><br><span class="line">        <span class="keyword">if</span> (m &lt; <span class="number">0</span>) m += <span class="number">26</span>;</span><br><span class="line">        value.push(m);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">exgcd</span>(<span class="params">a, b, v</span>) </span>&#123;<span class="comment">//扩展欧几里得算法求逆</span></span><br><span class="line">    <span class="keyword">if</span> (b === <span class="number">0</span>) &#123;</span><br><span class="line">        v.push(<span class="number">1</span>);</span><br><span class="line">        v.push(<span class="number">0</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        exgcd(b, a % b, v);</span><br><span class="line">        <span class="keyword">let</span> tmp = v[<span class="number">0</span>];</span><br><span class="line">        v[<span class="number">0</span>] = v[<span class="number">1</span>];</span><br><span class="line">        v[<span class="number">1</span>] = tmp - <span class="built_in">Math</span>.floor(a / b) * v[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">decode(c, k, value);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;仿射密码解密结果为：[&quot;</span> + value.toString() + <span class="string">&quot;]&quot;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p>维吉尼亚加密结果为：rzqpmx ovgd fwcl qvugmvy br jgqdtn</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> p = <span class="string">&quot;please keep this message in secret&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> k = <span class="string">&quot;computer&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params">p, k</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> l = k.length;</span><br><span class="line">    <span class="keyword">let</span> c = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; p.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p[i] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; p[i] &lt;= <span class="string">&#x27;z&#x27;</span>) &#123;</span><br><span class="line">            c += <span class="built_in">String</span>.fromCharCode(((p[i].charCodeAt(<span class="number">0</span>) + k[j % l].charCodeAt(<span class="number">0</span>) - <span class="number">2</span> * <span class="string">&#x27;a&#x27;</span>.charCodeAt(<span class="number">0</span>)) % <span class="number">26</span> + <span class="string">&#x27;a&#x27;</span>.charCodeAt(<span class="number">0</span>)));</span><br><span class="line">            j++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            c += p[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;维吉尼亚加密结果为：&quot;</span>+encode(p, k));</span><br></pre></td></tr></table></figure>
<h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><p>Hill密码加密结果为：[j,i,i,y]</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> k = [[<span class="number">8</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">5</span>], [<span class="number">6</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">10</span>], [<span class="number">5</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">9</span>], [<span class="number">10</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">4</span>]];</span><br><span class="line"><span class="keyword">const</span> i = <span class="number">4</span>;<span class="comment">//矩阵宽度</span></span><br><span class="line"><span class="keyword">const</span> p = <span class="string">&quot;hill&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decode</span>(<span class="params">p, k, i</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> l = p.length;</span><br><span class="line">    <span class="keyword">let</span> n = [[]];</span><br><span class="line">    <span class="keyword">let</span> j, r;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>, r = <span class="number">0</span>; j &lt; l / <span class="number">4</span> &amp;&amp; r &lt; l; r++) <span class="comment">//明文字符串转矩阵</span></span><br><span class="line">        n[j].push(p.charCodeAt(r) - <span class="string">&#x27;a&#x27;</span>.charCodeAt(<span class="number">0</span>));</span><br><span class="line">    j = <span class="built_in">Math</span>.floor(r / <span class="number">4</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Hill密码加密结果为：[&quot;</span> + matrMul(n, k, i, j).toString() + <span class="string">&quot;]&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">matrMul</span>(<span class="params">n, k, i, j</span>) </span>&#123;<span class="comment">//矩阵乘法</span></span><br><span class="line">    <span class="keyword">let</span> value = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> r = <span class="number">0</span>; r &lt; j; r++) &#123;</span><br><span class="line">        value[r] = [];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> h = <span class="number">0</span>; h &lt; i; h++) &#123;</span><br><span class="line">            value[r][h] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> q = <span class="number">0</span>; q &lt; i; q++) &#123;</span><br><span class="line">                value[r][h] += n[r][q] * k[q][h];</span><br><span class="line">            &#125;</span><br><span class="line">            value[r][h] = <span class="built_in">String</span>.fromCharCode((value[r][h] % <span class="number">26</span> + <span class="string">&#x27;a&#x27;</span>.charCodeAt(<span class="number">0</span>)));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">decode(p, k, i);</span><br></pre></td></tr></table></figure>
<h3 id="4"><a href="#4" class="headerlink" title="4"></a>4</h3><p>仿射密码密钥生成：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">generate_k</span>(<span class="params"></span>) </span>&#123;<span class="comment">//密钥生成</span></span><br><span class="line">    <span class="keyword">let</span> k = [];</span><br><span class="line">    k[<span class="number">0</span>] = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">25</span> + <span class="number">1</span>);<span class="comment">//选取1-25随机数</span></span><br><span class="line">    k[<span class="number">1</span>] = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">25</span> + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span> (husu(<span class="number">26</span>,k[<span class="number">1</span>] )!==<span class="literal">true</span>) &#123;</span><br><span class="line">        k[<span class="number">1</span>] = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">25</span> + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> k;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">husu</span>(<span class="params">a, b</span>) </span>&#123;<span class="comment">//互素判断--若gcd(a,b)=1，则互素</span></span><br><span class="line">    <span class="keyword">let</span> r;</span><br><span class="line">    <span class="keyword">while</span> (b &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        r = a % b;</span><br><span class="line">        a = b;</span><br><span class="line">        b = r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a === <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>仿射密码加密：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params">p, k</span>) </span>&#123;<span class="comment">//加密</span></span><br><span class="line">    <span class="keyword">let</span> l = p.length;</span><br><span class="line">    <span class="keyword">let</span> value = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; l; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p[i] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; p[i] &lt;= <span class="string">&#x27;z&#x27;</span>) &#123;</span><br><span class="line">            value += <span class="built_in">String</span>.fromCharCode((((p.charCodeAt(i) - <span class="string">&#x27;a&#x27;</span>.charCodeAt(<span class="number">0</span>)) * k[<span class="number">0</span>] + k[<span class="number">1</span>]) % <span class="number">26</span>) + <span class="string">&#x27;a&#x27;</span>.charCodeAt(<span class="number">0</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            value += p[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>仿射密码惟密文解密：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decode</span>(<span class="params">c</span>) </span>&#123;<span class="comment">//惟密文解密</span></span><br><span class="line">    <span class="keyword">let</span> value = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> l = c.length;</span><br><span class="line">    <span class="keyword">let</span> fre = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">26</span>)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</span><br><span class="line">        fre[i] = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">2</span>);</span><br><span class="line">        fre[i][<span class="number">0</span>] = i;</span><br><span class="line">        fre[i][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; l; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (c[i] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; c[i] &lt;= <span class="string">&#x27;z&#x27;</span>) &#123;</span><br><span class="line">            fre[c.charCodeAt(i) - <span class="string">&#x27;a&#x27;</span>.charCodeAt(<span class="number">0</span>)][<span class="number">1</span>]++;<span class="comment">//统计各字母出现次数</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    bubbleSort(fre);<span class="comment">//按字母出现频率排序</span></span><br><span class="line">    <span class="keyword">let</span> v = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">1</span>; j &lt; <span class="number">26</span>; j++) &#123;</span><br><span class="line">        <span class="keyword">let</span> x = DivideTwoCellOnce(fre[<span class="number">0</span>][<span class="number">0</span>], fre[j][<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">if</span> (!husu(x[<span class="number">0</span>], <span class="number">26</span>)) &#123;<span class="comment">//不互素--选取不合适</span></span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        exgcd(<span class="number">26</span>, x[<span class="number">0</span>], v);<span class="comment">//求a逆</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; l; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (c[i] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; c[i] &lt;= <span class="string">&#x27;z&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">let</span> m = (c.charCodeAt(i) - <span class="string">&#x27;a&#x27;</span>.charCodeAt(<span class="number">0</span>) - x[<span class="number">1</span>]) * v[<span class="number">1</span>] % <span class="number">26</span></span><br><span class="line">                <span class="keyword">if</span> (m &lt; <span class="number">0</span>)</span><br><span class="line">                    m += <span class="number">26</span>;<span class="comment">//保证取正数</span></span><br><span class="line">                value += <span class="built_in">String</span>.fromCharCode(<span class="string">&#x27;a&#x27;</span>.charCodeAt(<span class="number">0</span>) + m);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                value += c[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">console</span>.log(value.toString());</span><br><span class="line">        value = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">DivideTwoCellOnce</span>(<span class="params">x, y</span>) </span>&#123;<span class="comment">//模除</span></span><br><span class="line">    <span class="keyword">while</span> ((y - x) % <span class="number">15</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">        y += <span class="number">26</span>;</span><br><span class="line">    &#125;<span class="comment">//保证a为整数</span></span><br><span class="line">    <span class="keyword">let</span> a = (y - x) / <span class="number">15</span>;</span><br><span class="line">    <span class="keyword">while</span> (x - a * <span class="number">4</span> &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        x += <span class="number">26</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> b = x - a * <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">return</span> [a, b];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">exgcd</span>(<span class="params">a, b, v</span>) </span>&#123;<span class="comment">//扩展欧几里得算法求逆</span></span><br><span class="line">    <span class="keyword">if</span> (b === <span class="number">0</span>) &#123;</span><br><span class="line">        v.push(<span class="number">1</span>);</span><br><span class="line">        v.push(<span class="number">0</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        exgcd(b, a % b, v);</span><br><span class="line">        <span class="keyword">let</span> tmp = v[<span class="number">0</span>];</span><br><span class="line">        v[<span class="number">0</span>] = v[<span class="number">1</span>];</span><br><span class="line">        v[<span class="number">1</span>] = tmp - <span class="built_in">Math</span>.floor(a / b) * v[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bubbleSort</span>(<span class="params">fre</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> l = fre.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; l; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; l - <span class="number">1</span> - i; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (fre[j][<span class="number">1</span>] &lt; fre[j + <span class="number">1</span>][<span class="number">1</span>]) &#123;        <span class="comment">//相邻元素两两对比</span></span><br><span class="line">                <span class="keyword">let</span> tmp = fre[j + <span class="number">1</span>];        <span class="comment">//元素交换</span></span><br><span class="line">                fre[j + <span class="number">1</span>] = fre[j];</span><br><span class="line">                fre[j] = tmp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>单表代换密钥生成：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">generate_k</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> k = [...new <span class="built_in">Array</span>(<span class="number">25</span>).keys()];</span><br><span class="line">    arr_random(k);</span><br><span class="line">    <span class="keyword">return</span> k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">arr_random</span>(<span class="params">arr</span>)</span>&#123;<span class="comment">//数组随机排序</span></span><br><span class="line">    <span class="keyword">let</span> index=arr.length;</span><br><span class="line">    <span class="keyword">while</span>(index)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> random=<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random()*index);</span><br><span class="line">        index--;</span><br><span class="line">        <span class="keyword">let</span> tmp=arr[index];</span><br><span class="line">        arr[index]=arr[random];</span><br><span class="line">        arr[random]=tmp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>单表代换加密：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params">p, k</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> c = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> l = p.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; l; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p[i] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; p[i] &lt;= <span class="string">&#x27;z&#x27;</span>) &#123;</span><br><span class="line">            c += <span class="built_in">String</span>.fromCharCode(<span class="string">&#x27;a&#x27;</span>.charCodeAt(<span class="number">0</span>) + k[p.charCodeAt(i) - <span class="string">&#x27;a&#x27;</span>.charCodeAt(<span class="number">0</span>)]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            c += p[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>单表代换解密：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decode</span>(<span class="params">c, k</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> p = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> l = c.length;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; l; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (c[i] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; c[i] &lt;= <span class="string">&#x27;z&#x27;</span>) &#123;</span><br><span class="line">            p += <span class="built_in">String</span>.fromCharCode(<span class="string">&#x27;a&#x27;</span>.charCodeAt(<span class="number">0</span>) + k.findIndex(<span class="function"><span class="params">value</span> =&gt;</span> value === c.charCodeAt(i) - <span class="string">&#x27;a&#x27;</span>.charCodeAt(<span class="number">0</span>)));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            p += c[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5"><a href="#5" class="headerlink" title="5"></a>5</h3><p>穷尽搜索的复杂度:<br>|    |   |<br>| – | – |<br>|移位|$25$|<br>|仿射| $\Phi (26)*26=312$|<br>|单表代换|$26!$|<br>|维吉尼亚|$26^m$|<br>|多表代换|$26^m$|<br>|置换:|$m!$|</p>
<h3 id="6"><a href="#6" class="headerlink" title="6"></a>6</h3><p>分组加密:多表代换，置换密码，希尔密码。<br>因为他们都要先将明文分组，然后分别和密钥进行加密操作。</p>
<h3 id="7"><a href="#7" class="headerlink" title="7"></a>7</h3><p>猜测密钥长度为：7<br>密钥对应数字为：15,17,14,20,3,4,17<br>解密结果为andfinallybuildacommunitynoonedoesbigthingsbythemselvesrightnowwhenpeoplearescareditiseasytobecynicalandsayletmejustlookoutformyselformyfamilyorpeoplewholookor<br>thinkorpraylikemebutifwearegoingtogetthroughthesedifficulttimesifwearegoingtocreateaworldwhereeverybodyhastheopportunitytofindajobandaffordcollegeifwearegoingtosavetheen<br>vironmentanddefeatfuturepandemicsthenwearegoingtohavetodoittogether</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> c = <span class="string">&quot;Per zlrracm, vxmcs r qipqlczhs. Qs fcv rihw sxxhblrxh sm nkidhvzphw. Ixxvn qsn, lysh sifecs uuijrrfyg, mk xj suvc kd ss wbrzrrz uqh jpp zyw qv ylgn osfz fin isi bpgyoj, fg dm zdqzap, cl sifecsqks cdfy iu xyxey iu tipp zcni dt. Sin lj nt rfy jszcxhi jik iyfixky iysmh hzuwwwxpk izayv; mw lv olhkfxeu nr gitrhy d afgcr qkiit vjyucsdum bdw kwvcjssiilbcwc kd wwhg e ads, ohg ewuffx fscavuy; ljnt rfy jszcx hi vemt kvy hrmxichpiei rbx giwtrhzxxlgv duqhvbzqm, wlvc ns uui xdzba ws ypmsnr hf xk hijikwvf.&quot;</span></span><br><span class="line">c = pre(c);</span><br><span class="line"><span class="keyword">let</span> key = exp(c);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;解密结果为&quot;</span> + decode(key, c.length, c).toString());</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pre</span>(<span class="params">c</span>) </span>&#123;<span class="comment">//去掉非字母符号，方便计算index</span></span><br><span class="line">    <span class="keyword">return</span> c.toLowerCase().match(<span class="regexp">/[a-z]/g</span>).join(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Kasiski</span>(<span class="params">c, l</span>) </span>&#123;<span class="comment">//猜解秘钥长度</span></span><br><span class="line">    <span class="keyword">let</span> n = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> value = [];<span class="comment">//间距数组</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i + <span class="number">5</span> &lt; l; i++) &#123;<span class="comment">//一个一个试？不知道有没有更好的方法</span></span><br><span class="line">        <span class="keyword">let</span> substr = c.substring(i, i + <span class="number">3</span>);</span><br><span class="line">        <span class="keyword">let</span> begin = i;</span><br><span class="line">        <span class="keyword">let</span> j = KMP(c.substring(begin + <span class="number">3</span>), substr);<span class="comment">//当前位置+3向后到匹配j</span></span><br><span class="line">        <span class="keyword">while</span> (j !== -<span class="number">1</span>)<span class="comment">//匹配到了</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (value.indexOf(j + <span class="number">3</span>) === -<span class="number">1</span>) &#123;</span><br><span class="line">                value[n] = j + <span class="number">3</span>;</span><br><span class="line">                n += <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            begin += j + <span class="number">3</span>;</span><br><span class="line">            j = KMP(c.substring(begin + <span class="number">3</span>), substr);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (value[<span class="number">4</span>]) <span class="keyword">break</span>;<span class="comment">//取5个间隔</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        value[i + <span class="number">1</span>] = gcd(value[i], value[i + <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> value[n - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">exp</span>(<span class="params">c</span>) </span>&#123;<span class="comment">//拟重合指数法确认密钥</span></span><br><span class="line">    <span class="keyword">let</span> q = [<span class="number">8.19</span>, <span class="number">1.47</span>, <span class="number">3.83</span>, <span class="number">3.91</span>, <span class="number">12.25</span>, <span class="number">2.26</span>, <span class="number">1.71</span>, <span class="number">4.57</span>, <span class="number">7.10</span>, <span class="number">0.14</span>, <span class="number">0.41</span>, <span class="number">3.77</span>, <span class="number">3.34</span>, <span class="number">7.06</span>, <span class="number">7.26</span>, <span class="number">2.89</span>, <span class="number">0.09</span>, <span class="number">6.85</span>,</span><br><span class="line">        <span class="number">6.36</span>, <span class="number">9.41</span>, <span class="number">2.58</span>, <span class="number">1.09</span>, <span class="number">1.59</span>, <span class="number">0.21</span>, <span class="number">1.58</span>, <span class="number">0.08</span>]</span><br><span class="line">    <span class="keyword">let</span> l = c.length;</span><br><span class="line">    <span class="keyword">let</span> key = [];</span><br><span class="line">    <span class="keyword">let</span> key_length = Kasiski(c, l);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;猜测密钥长度为：&quot;</span> + key_length);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; key_length; j++) &#123;</span><br><span class="line">        <span class="keyword">let</span> val = divide_c(c, l, key_length, j);</span><br><span class="line">        <span class="keyword">let</span> p = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">26</span>).fill(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; l; j++)</span><br><span class="line">            p[val.charCodeAt(j) - <span class="string">&#x27;a&#x27;</span>.charCodeAt(<span class="number">0</span>)]++;<span class="comment">//统计各字母出现次数</span></span><br><span class="line">        to_fre(p, <span class="number">26</span>);<span class="comment">//处理为频率</span></span><br><span class="line">        key[j] = correlation(p, q);<span class="comment">//算卷积</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;密钥对应数字为：&quot;</span> + key.toString());</span><br><span class="line">    <span class="keyword">return</span> key;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decode</span>(<span class="params">key, l, c</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> key_length = key.length;</span><br><span class="line">    <span class="keyword">let</span> v = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; l; i++)</span><br><span class="line">        v += <span class="built_in">String</span>.fromCharCode((c.charCodeAt(i) - <span class="string">&#x27;a&#x27;</span>.charCodeAt(<span class="number">0</span>) - key[i % key_length] + <span class="number">26</span>) % <span class="number">26</span> + <span class="string">&#x27;a&#x27;</span>.charCodeAt(<span class="number">0</span>));</span><br><span class="line">    <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">divide_c</span>(<span class="params">c, l, key, time</span>) </span>&#123;<span class="comment">//密文分组的第time列</span></span><br><span class="line">    <span class="keyword">let</span> div = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = time; i &lt; l; i += key) &#123;</span><br><span class="line">        div += c[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> div;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">correlation</span>(<span class="params">p, q</span>) </span>&#123;<span class="comment">//算卷积</span></span><br><span class="line">    <span class="keyword">let</span> max = <span class="number">0</span>, cor = <span class="number">0</span>, key;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</span><br><span class="line">        cor = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; <span class="number">26</span>; j++) &#123;</span><br><span class="line">            cor += p[(j + i) % <span class="number">26</span>] * q[j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (cor &gt; max) &#123;</span><br><span class="line">            max = cor;</span><br><span class="line">            key = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">to_fre</span>(<span class="params">a, l</span>) </span>&#123;<span class="comment">//出现次数----&gt;频率</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; l; i++) &#123;</span><br><span class="line">        a[i] = (a[i] / l).toFixed(<span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gcd</span>(<span class="params">a, b</span>) </span>&#123;<span class="comment">//求最大公因数</span></span><br><span class="line">    <span class="keyword">let</span> r;</span><br><span class="line">    <span class="keyword">while</span> (b &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        r = a % b;</span><br><span class="line">        a = b;</span><br><span class="line">        b = r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">kmpGetStrPartMatchValue</span>(<span class="params">str</span>) </span>&#123;<span class="comment">//KMP算法字符串匹配</span></span><br><span class="line">    <span class="keyword">let</span> prefix = [];</span><br><span class="line">    <span class="keyword">let</span> suffix = [];</span><br><span class="line">    <span class="keyword">let</span> partMatch = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, j = str.length; i &lt; j; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> newStr = str.substring(<span class="number">0</span>, i + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (newStr.length === <span class="number">1</span>)</span><br><span class="line">            partMatch[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> k = <span class="number">0</span>; k &lt; i; k++) &#123;</span><br><span class="line">                prefix[k] = newStr.slice(<span class="number">0</span>, k + <span class="number">1</span>);</span><br><span class="line">                suffix[k] = newStr.slice(-k - <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span> (prefix[k] === suffix[k])</span><br><span class="line">                    partMatch[i] = prefix[k].length;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!partMatch[i])</span><br><span class="line">                partMatch[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> partMatch;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">KMP</span>(<span class="params">sourceStr, searchStr</span>) </span>&#123;<span class="comment">//KMP字符串匹配</span></span><br><span class="line">    <span class="keyword">let</span> part = kmpGetStrPartMatchValue(searchStr);</span><br><span class="line"><span class="comment">//    let sourceLength = sourceStr.length;</span></span><br><span class="line">    <span class="keyword">let</span> searchLength = searchStr.length;</span><br><span class="line">    <span class="keyword">let</span> result;</span><br><span class="line">    <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//    let j = 0;</span></span><br><span class="line">    <span class="keyword">for</span> (; i &lt; sourceStr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; searchLength; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (searchStr.charAt(j) === sourceStr.charAt(i)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (j === searchLength - <span class="number">1</span>) &#123;</span><br><span class="line">                    result = i - j;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span></span><br><span class="line">                    i++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (j &gt; <span class="number">1</span> &amp;&amp; part[j - <span class="number">1</span>] &gt; <span class="number">0</span>)</span><br><span class="line">                    i += (i - j - part[j - <span class="number">1</span>]);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    i = (i - j)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (result || result === <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (result || result === <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></article><!-- lincense--><div class="license-wrapper"><p> <span>Author:  </span><a href="https://suyumen.github.io">suyumen</a></p><p> <span>Link:  </span><a href="https://suyumen.github.io/2022/03/20/2022-03-20-%E9%83%A8%E5%88%86%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81%E5%AE%9E%E7%8E%B0/">https://suyumen.github.io/2022/03/20/2022-03-20-%E9%83%A8%E5%88%86%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81%E5%AE%9E%E7%8E%B0/</a></p><p> <span>Copyright:  </span><span>All articles in this blog are licensed under <a rel="license noopener" target="_blank" href="https://creativecommons.org/licenses/by-nc-nd/3.0">CC BY-NC-SA 3.0</a> unless stating additionally.</span></p></div><div class="post-paginator"><a class="prevSlogan" href="/2022/03/25/2022-03-25-CVE-2021-21315%E5%A4%8D%E7%8E%B0/" title="CVE-2021-21315复现"><span>< PreviousPost</span><br><span class="prevTitle">CVE-2021-21315复现</span></a><a class="nextSlogan" href="/2022/01/17/2022-01-17-%5B%E6%B9%96%E6%B9%98%E6%9D%AF%202021%20final%5Dvote/" title="湖湘杯2021final-vote"><span>NextPost ></span><br><span class="nextTitle">湖湘杯2021final-vote</span></a><div class="clear"></div></div><div id="comment"></div></section></article><footer id="cxo-footer-outer"><div id="cxo-footer-inner"><p class="footer-container"><span>Site by <span>Hexo</span></span><span> | theme <span>Cxo</span></span></p><i class="fa fa-user"> </i><span id="busuanzi_value_site_uv"></span><span> | </span><i class="fa fa-eye"> </i><span id="busuanzi_value_site_pv"></span></div></footer><!-- catelog--><div class="toc-wrapper" style="top: 70vh;"><div class="toc-catalog"><i class="fa fa-list"> </i><span>CATALOG</span></div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#2"><span class="toc-number">1.</span> <span class="toc-text">2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3"><span class="toc-number">2.</span> <span class="toc-text">3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4"><span class="toc-number">3.</span> <span class="toc-text">4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5"><span class="toc-number">4.</span> <span class="toc-text">5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6"><span class="toc-number">5.</span> <span class="toc-text">6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7"><span class="toc-number">6.</span> <span class="toc-text">7</span></a></li></ol></div><!-- top--><i class="fa fa-arrow-up close" id="go-up" aria-hidden="true"></i></body></html>